<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <title>Database Access - Parka</title>
    <meta name="generator" content="Hugo 0.15" />

    
    <meta name="description" content="Documentation for the TypeScript server framework, Parka.">
    
    <link rel="canonical" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/database-access/">
    
    <meta name="author" content="Derek Pavao">
    

    <meta property="og:url" content="http://parka-docs.s3-website-us-east-1.amazonaws.com/database-access/">
    <meta property="og:title" content="Parka">
    <meta property="og:image" content="http://parka-docs.s3-website-us-east-1.amazonaws.com/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Parka">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://parka-docs.s3-website-us-east-1.amazonaws.com/fonts/icon.eot?52m981');
        src: url('http://parka-docs.s3-website-us-east-1.amazonaws.com/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('http://parka-docs.s3-website-us-east-1.amazonaws.com/fonts/icon.woff?52m981')
               format('woff'),
             url('http://parka-docs.s3-website-us-east-1.amazonaws.com/fonts/icon.ttf?52m981')
               format('truetype'),
             url('http://parka-docs.s3-website-us-east-1.amazonaws.com/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/stylesheets/application.css">
    <link rel="stylesheet" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu%2bMono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>
    
    
    <script src="http://parka-docs.s3-website-us-east-1.amazonaws.com/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-light green">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Database Access
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/dotDeeka" title="@dotDeeka on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://parka-docs.s3-website-us-east-1.amazonaws.com/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://parka-docs.s3-website-us-east-1.amazonaws.com/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Parka <span class="version">0.2.3</span></strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="http://parka-docs.s3-website-us-east-1.amazonaws.com/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="http://parka-docs.s3-website-us-east-1.amazonaws.com/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    


<a  title="Parka" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/">
	Parka
</a>

  
  
</li>



<li>
  
    


<a  title="Getting started" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/getting-started/">
	Getting started
</a>

  
  
</li>



<li>
  
    


<a  title="Resource Classes" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/resource-classes/">
	Resource Classes
</a>

  
  
</li>



<li>
  
    


<a class="current" title="Database Access" href="http://parka-docs.s3-website-us-east-1.amazonaws.com/database-access/">
	Database Access
</a>


<ul id="scrollspy">
</ul>
  
  
</li>

        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/dotDeeka" target="_blank" title="@dotDeeka on GitHub">
              @dotDeeka on GitHub
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Database Access </h1>

			

<h2 id="overview">Overview</h2>

<p>Parka uses a great lightweight ORM that mostly stays out of the developers way.
<a href="http://vincit.github.io/objection.js/#relationexpression">Objection.js</a>. And Parka mostly stays out of the way
as well.</p>

<p>The only thing required for a model from Parka is that you extend <code>ParkaModel</code> and you decorate your model class
with <code>@TableName('name_of_the_table')</code> Other than that, its just Objection.js</p>

<h2 id="example">Example</h2>

<p>The Todos model</p>

<pre><code class="language-javascript">import {ParkaModel, TableName} from 'parka';

@TableName('Todo')
export let Todo extend ParkaModel {

  public title: string;
  public description: string;
  public done: number;
}
</code></pre>

<h2 id="validation">Validation</h2>

<p>Objection.js validates models by a <a href="http://json-schema.org/">JsonSchema</a> definition defined as a static property on your model.
For example to define our Todo model and make title and description required, give title a maximum length, and give done a
default value of 0, it would look like the following;</p>

<pre><code class="language-javascript">import {ParkaModel, TableName} from 'parka';

@TableName('Todo')
export let Todo extend ParkaModel {

  public static jsonSchema = {
    type: 'object',
    required: ['title', 'description'],

    properties: {
      title: {
        type: 'string',
        maxLength: 50
      },
      description: {
        type: 'string'
      },
      done: {
        type: 'integer',
        default: 0
      }
    }
  };

  public title: string;
  public description: string;
  public done: number;
}
</code></pre>

<p>In the future it is possible that Parka will provide some syntactic sugar for defining these constraints, mostlikely with
decorator metadata. However, for now defining the static jsonSchema property is easy enough.</p>

<p>For more information on <a href="http://vincit.github.io/objection.js/#relationexpression">Objection.js</a> check out their website</p>

<div class="admonition note">
<p class="admonition-title">Promises and Objection.js&#39;s QueryBuilder</p>
<p>Objection.js uses Promises/Thenables and Parka is designed to work well with them. Objection.js&rsquo;s query methods all return an
instance of their QueryBuilder. If you return a QueryBuilder instance or a Promise/Thenable from any Parka Resource method, Parka
will wait till that call is resolved completely and then return the resolved value to the client.</p>
</div>

<h2 id="example-w-promises">Example w/ Promises</h2>

<p>Our Todo model above inherits some methods from Objection.js, one of which is <code>query()</code>. The query() method returns a promise
that resolves with a complete list of everything from the given models table, i.e. Todo.</p>

<pre><code class="language-javascript">import {Path, GET} from 'parka';
import {Todo} from '../models/todo';


@Path('/todo')
export class TodoResource {

  @GET
  public getListOfTodos() {
    return Todo.query();
  }

}
</code></pre>

<p>Lets say you had two lists of models you wanted to return in the same request</p>

<pre><code class="language-javascript">import {Path, GET} from 'parka';
import {Todo} from '../models/todo';
import {AnotherModel} from '../models/todo';
import * as Promise from 'bluebird';


@Path('/todo')
export class TodoResource {

  @GET
  @Path('/with-other-model')
  public getListOfTodosWithOtherModelList() {

    return Promise.all([
      Todo.query(),
      AnotherModel.query()
    ])
    .spread(function (todos, otherModels) {
      return {
        todos: todos,
        otherModels: otherModels
      };
    });
  }
}
</code></pre>

<p>In the above examples, Parka will handle returning the resolved value to the client for you. For more info check out the section
of these docs about Resource Classes</p>

			
			<aside class="copyright" role="note">
				
				&copy; 2016 Released under the MIT license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">
					Material
				</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://parka-docs.s3-website-us-east-1.amazonaws.com/resource-classes/" title="Resource Classes">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Resource Classes
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
  </div>
</nav>




			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="http://parka-docs.s3-website-us-east-1.amazonaws.com/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(headers.length > 0) {
        for(var i = 0; i < headers.length; i++) {
          var li = document.createElement("li");
          li.setAttribute("class", "anchor");

          var a  = document.createElement("a");
          a.setAttribute("href", "#" + headers[i].id);
          a.setAttribute("title", headers[i].innerHTML);
          a.innerHTML = headers[i].innerHTML;
          
          li.appendChild(a)
          scrollspy.appendChild(li);
        }
      } else {
        scrollspy.parentElement.removeChild(scrollspy)
      }
      

      /* Add permanent link next to the headers */
      var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

      for(var i = 0; i < headers.length; i++) {
          var a = document.createElement("a");
          a.setAttribute("class", "headerlink");
          a.setAttribute("href", "#" + headers[i].id);
          a.setAttribute("title", "Permanent link")
          a.innerHTML = "#";
          headers[i].appendChild(a);
      }
    </script>

    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>