<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <title>Getting Started Creating the TodoMVC API - Parka</title>
    <meta name="generator" content="Hugo 0.15" />

    
    <meta name="description" content="Documentation for the TypeScript server framework, Parka.">
    
    <link rel="canonical" href="http://dotdeeka.github.io/parka/getting-started/">
    
    <meta name="author" content="Derek Pavao">
    

    <meta property="og:url" content="http://dotdeeka.github.io/parka/getting-started/">
    <meta property="og:title" content="Parka">
    <meta property="og:image" content="http://dotdeeka.github.io/parka/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="Parka">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://dotdeeka.github.io/parka/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="http://dotdeeka.github.io/parka/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://dotdeeka.github.io/parka/fonts/icon.eot?52m981');
        src: url('http://dotdeeka.github.io/parka/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('http://dotdeeka.github.io/parka/fonts/icon.woff?52m981')
               format('woff'),
             url('http://dotdeeka.github.io/parka/fonts/icon.ttf?52m981')
               format('truetype'),
             url('http://dotdeeka.github.io/parka/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://dotdeeka.github.io/parka/stylesheets/application.css">
    <link rel="stylesheet" href="http://dotdeeka.github.io/parka/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://dotdeeka.github.io/parka/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu%2bMono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>
    
    
    <script src="http://dotdeeka.github.io/parka/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-blue palette-accent-light green">



	
	


<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Getting Started Creating the TodoMVC API
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/dotDeeka" title="@dotDeeka on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://dotdeeka.github.io/parka/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://dotdeeka.github.io/parka/images/logo.png">
        </div>
      
      <div class="name">
        <strong>Parka <span class="version">0.2.3</span></strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            <a href="http://dotdeeka.github.io/parka/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="http://dotdeeka.github.io/parka/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      

      <div class="toc">
        
        <ul>
          




<li>
  
    


<a  title="Parka" href="http://dotdeeka.github.io/parka/">
	Parka
</a>

  
  
</li>



<li>
  
    


<a class="current" title="Getting started" href="http://dotdeeka.github.io/parka/getting-started/">
	Getting started
</a>


<ul id="scrollspy">
</ul>
  
  
</li>



<li>
  
    


<a  title="Resource Classes" href="http://dotdeeka.github.io/parka/resource-classes/">
	Resource Classes
</a>

  
  
</li>



<li>
  
    


<a  title="Database Access" href="http://dotdeeka.github.io/parka/database-access/">
	Database Access
</a>

  
  
</li>

        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/dotDeeka" target="_blank" title="@dotDeeka on GitHub">
              @dotDeeka on GitHub
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Getting Started Creating the TodoMVC API </h1>

			

<h2 id="global-dependencies">Global Dependencies</h2>

<p>Parka has a few global dependencies</p>

<pre><code class="language-bash">$ npm install -g parka typescript ts-node pm2 nodemon typings
</code></pre>

<h2 id="a-typical-directory-structure">A typical Directory Structure</h2>

<pre><code>├── api // This is the directory that holds all the source files for your application
│   ├── app-config.ts // The config class for your application
│   ├── app.ts // The main application class
│   ├── config.yml // The settings and configuration for your application, you could have more than one of these
│   ├── models // Data model classes
│   │   └── todo.ts
│   └── resources // Resources classes, these classes define your routes
│       └── todo-resource.ts
├── dist // If you run parka start with the --production flag, TypeScript file are transpiled here before the app is run
├── logs // when running app with parka start log files are written here
├── package.json
├── tsconfig.json
├── typings // type definition files for any libraries you're using. This dir is created by the typings cli
│   ├── browser
│   │   ├── ambient
│   │   └── definitions
│   ├── browser.d.ts
│   ├── main
│   │   ├── ambient
│   │   └── definitions
│   └── main.d.ts
├── typings.json
└── README.md

</code></pre>

<h1 id="creating-the-todomvc-api">Creating the TodoMVC api</h1>

<pre><code class="language-bash">$ mkdir todos

# cd to the todos directory

$ cd todos
</code></pre>

<h2 id="initialize-a-package-json-file">Initialize a package.json file</h2>

<pre><code class="language-bash">npm init

# follow the prompts and answer all the question
</code></pre>

<h2 id="create-a-typings-json">Create a typings.json</h2>

<p>This file will hold the type definitions for some of the JS libraries, you&rsquo;ll be adding to this with <code>typings install someJSModule --save</code> as you develop your app</p>

<h2 id="create-a-tsconfig-json">Create a tsconfig.json</h2>

<p>This file tells ts-node and the TypeScript compiler how to compile the typescript</p>

<p>./tsconfig.json</p>

<pre><code class="language-javascript">{
  &quot;compilerOptions&quot;: {
    &quot;module&quot;: &quot;commonjs&quot;,
    &quot;target&quot;: &quot;es5&quot;,
    &quot;noImplicitAny&quot;: false,
    &quot;sourceMap&quot;: true,
    &quot;moduleResolution&quot;: &quot;node&quot;,
    &quot;emitDecoratorMetadata&quot;: true,
    &quot;experimentalDecorators&quot;: true,
    &quot;rootDir&quot;: &quot;api&quot;,
    &quot;outDir&quot;: &quot;dist&quot;
  },
  &quot;exclude&quot;: [
    &quot;node_modules&quot;,
    &quot;typings/browser&quot;,
    &quot;typigns/browser.d.ts&quot;
  ],
  &quot;compileOnSave&quot;: false
}
</code></pre>

<p>./typings.json</p>

<pre><code class="language-javascript">{
  &quot;ambientDependencies&quot;: {
    &quot;bluebird&quot;: &quot;registry:dt/bluebird#2.0.0+20160319051630&quot;,
    &quot;express&quot;: &quot;registry:dt/express#4.0.0+20160317120654&quot;,
    &quot;express-serve-static-core&quot;: &quot;registry:dt/express-serve-static-core#0.0.0+20160317120654&quot;,
    &quot;knex&quot;: &quot;registry:dt/knex#0.0.0+20160321150906&quot;,
    &quot;mime&quot;: &quot;registry:dt/mime#0.0.0+20160316155526&quot;,
    &quot;node&quot;: &quot;registry:dt/node#4.0.0+20160319033040&quot;,
    &quot;serve-static&quot;: &quot;registry:dt/serve-static#0.0.0+20160317120654&quot;
  },
  &quot;dependencies&quot;: {
    &quot;lodash&quot;: &quot;registry:npm/lodash#4.0.0+20160305082308&quot;,
    &quot;objection&quot;: &quot;github:dotDeeka/objection-d-ts/typings.json#master&quot;
  }
}
</code></pre>

<h2 id="installing-our-typings-and-parka-locally">Installing our typings and Parka locally</h2>

<pre><code class="language-bash">$ npm install parka --save
$ typings install
</code></pre>

<h1 id="app-files">App Files</h1>

<p>Now that we&rsquo;re set up we can get started on the application it self. Every Parka app requires a main application class, a configuration class and a config.yml file. When a Parka app boots up,
the configuration yaml file is deserialized into an instance of your configuration class, this is a great place to put environment specific parameters, database connection parameters and such.</p>

<p>We&rsquo;ll put all of our source files in a directory <code>./api</code>, we could call this anything really. Typical names would also be <code>./app</code> or <code>./src</code></p>

<h2 id="creating-a-configuration-class">Creating a configuration class</h2>

<p>Our configuration class here is going to be extremely simple. Its going to be empty. However we&rsquo;re going to extend ParkaConfig which will handle configuration for things like database connections.</p>

<p>./api/app-config.ts</p>

<pre><code class="language-javascript">import {ParkaConfig} from 'parka';

export class AppConfig extends ParkaConfig {

}
</code></pre>

<h2 id="config-yml">config.yml</h2>

<p>When you start your app you will give it a configuration yaml file to use. You would probably have a few of these for different environments. But here we&rsquo;re just going to have one
with some simple database connection parameters defined in it.</p>

<p>./api/config.yml</p>

<pre><code class="language-yaml">appName: TodoMVC-API
env: dev
host: 127.0.0.1
port: 3000
db:
  client: sqlite3
  connection:
    filename: ./db.sqlite
  useNullAsDefault: true
</code></pre>

<h2 id="install-sqlite3">Install sqlite3</h2>

<p>You will mostlikely need to install sqlite3 on your system using a package manager, and the npm module for it</p>

<pre><code class="language-bash"># This command is for OSX users using homebrew, For other package managers apt, yum, NuGet you will have to google it
$ brew install sqlite3

$ npm install sqlite3 --save

# create the database file, this also logs you in
$ sqlite3 db.sqlite
</code></pre>

<p>Execute the following create table statement to create our Todo table</p>

<pre><code class="language-sql">CREATE TABLE Todo (
  id INTEGER PRIMARY KEY,
  title varchar(255) NOT NULL,
  description TEXT NOT NULL,
  done INTEGER
);
</code></pre>

<pre><code>$ .exit
</code></pre>

<h2 id="creating-an-application-class">Creating an application class</h2>

<p>Our application class is the main entry point into our application. It is where we will register all our Resource Classes with Parka. Registering these
classes will take place in the <code>onBeforeApplicationStart()</code> lifecycle callback</p>

<p>./api/app.ts</p>

<pre><code class="language-javascript">import {ParkaApp} from 'parka';
import {AppConfig} from './app-config';
import {TodoResource} from './resources/todo-resource';

class App extends ParkaApp&lt;AppConfig&gt; {

  public onBeforeApplicationStart() {

    this.registerResource(TodoResource);
  }
}

// Instatiate and export a new instance of your application
export let app = new App(AppConfig);
</code></pre>

<h2 id="creating-a-model-to-represent-our-todo">Creating a Model to represent our Todo</h2>

<p>./api/models/todo.ts</p>

<pre><code class="language-javascript">import {ParkaModel, TableName} from 'parka';

@TableName('Todo')
export let Todo extend ParkaModel {

  public static jsonSchema = {
    type: 'object',
    required: ['title', 'description'],

    properties: {
      title: {
        type: 'string',
        maxLength: 50
      },
      description: {
        type: 'string'
      },
      done: {
        type: 'integer',
        default: 0
      }
    }
  };

  public title: string;
  public description: string;
  public done: number;
}
</code></pre>

<p>This model is using Objection.js, you can read more about it in the DatabaseAccess section of these docs.</p>

<h2 id="routes-and-resource-classes">Routes and Resource classes</h2>

<p>We are going to create a resource class that will define routes to do simple CRUD on a Todo. More info
on defining Resource Classes can be found in the Resource Classes section of these docs</p>

<p>./api/resources/todo-resource.ts</p>

<pre><code class="language-javascript">import {
    Path,
    GET,
    POST,
    PUT,
    RequestBody,
    PathParam
} from 'parka';

import {Todo} from '../models/todo';


@Path('/todo')
export class TodoResource {

    @GET
    public getListOfTodos() {

        return Todo.query();
    }

    @GET
    @Path('/:id')
    public getTodoById(@PathParam('id') id: string) {

        return Todo.query()
            .findById(id);
    }

    @POST
    public createNewTodo(@RequestBody(Todo) todo: Todo) {

        return Todo.query()
            .insert(todo);
    }

    @PUT
    @Path('/:id')
    public updateTodo(@PathParam('id') id: string,
                      @RequestBody(Todo) todo: Todo): any {

        if (todo.id !== Number(id)) {

            return Promise.reject({statusCode: 419, message: 'Conflict there was a id mismatch'});
        } else {
            return Todo.query()
                .updateAndFetchById(id, todo);
        }
    }
}

</code></pre>

<h2 id="run-the-app">Run the app</h2>

<p>Lets run the app in dev mode where it will watch for changes and reload the app when they occur. From the root
directory of the project run&hellip;</p>

<pre><code class="language-bash">$ parka watch api/app.ts api/config.yml
</code></pre>

<p>Your app should be running on <a href="http://localhost:3000">http://localhost:3000</a></p>

			
			<aside class="copyright" role="note">
				
				&copy; 2016 Released under the MIT license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">
					Material
				</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://dotdeeka.github.io/parka/" title="Parka">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Parka
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://dotdeeka.github.io/parka/resource-classes/" title="Resource Classes">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Resource Classes
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>




			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="http://dotdeeka.github.io/parka/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(headers.length > 0) {
        for(var i = 0; i < headers.length; i++) {
          var li = document.createElement("li");
          li.setAttribute("class", "anchor");

          var a  = document.createElement("a");
          a.setAttribute("href", "#" + headers[i].id);
          a.setAttribute("title", headers[i].innerHTML);
          a.innerHTML = headers[i].innerHTML;
          
          li.appendChild(a)
          scrollspy.appendChild(li);
        }
      } else {
        scrollspy.parentElement.removeChild(scrollspy)
      }
      

      /* Add permanent link next to the headers */
      var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

      for(var i = 0; i < headers.length; i++) {
          var a = document.createElement("a");
          a.setAttribute("class", "headerlink");
          a.setAttribute("href", "#" + headers[i].id);
          a.setAttribute("title", "Permanent link")
          a.innerHTML = "#";
          headers[i].appendChild(a);
      }
    </script>

    

    <script src="//gohugo.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>